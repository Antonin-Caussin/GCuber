% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/carbofor.R
\name{carbofor.carbofor_data}
\alias{carbofor.carbofor_data}
\title{Compute tree volume, bark thickness, biomass and carbon from a data.frame}
\usage{
\method{carbofor}{carbofor_data}(
  x,
  volume_type = "V22",
  equation_id = 1,
  carbon = FALSE,
  bark = FALSE,
  remove_na = FALSE,
  source = "Dagnellie",
  specimens = NULL,
  D130 = "D130",
  C130 = "C130",
  HTOT = "HTOT",
  HDOM = "HDOM",
  D150 = "D150",
  C150 = "C150",
  H = "H",
  biomass_method = "volume",
  ...
)
}
\arguments{
\item{x}{A `data.frame` of class `carbofor_data` containing individual tree measurements.
Must include at least species identification and diameter data.}

\item{volume_type}{Character. The type of volume to compute. Common values include:
"V22" (commercial volume over bark), "V22B" (under bark), "V22_HA" (per hectare), or "E" (gross volume).}

\item{equation_id}{Integer. Index of the equation to apply per species when multiple models are available.
Default is 1.}

\item{carbon}{Logical. If `TRUE`, aboveground biomass and carbon content are computed.}

\item{bark}{Logical. If `TRUE`, bark thickness and bark-adjusted volume are computed.}

\item{remove_na}{Logical. If `TRUE`, rows with missing computed volume are removed from the output.}

\item{source}{Character. Identifier of the source for the equations (e.g., "Dagnellie", "Vallet", "Bouvard").}

\item{specimens}{Character. Name of the column in `x` used to identify species (e.g., code, abbreviation, or full name).}

\item{D130}{Character. Column name for diameter at 130 cm height (default = "D130").}

\item{C130}{Character. Column name for circumference at 130 cm height (default = "C130").}

\item{HTOT}{Character. Column name for total tree height (default = "HTOT").}

\item{HDOM}{Character. Column name for dominant height (used for plot-level scaling).}

\item{D150}{Character. Column name for diameter at 150 cm height (default = "D150").}

\item{C150}{Character. Column name for circumference at 150 cm height (default = "C150").}

\item{H}{Character. Optional column name for another height variable used in some equations.}

\item{biomass_method}{Character. Method used to compute biomass if `carbon = TRUE`.
Options are "volume" (volume × density) or "equation" (species-specific biomass model).}

\item{...}{Additional arguments passed to internal helper functions (not used directly here).}
}
\value{
A `data.frame` identical to `x` but enriched with additional columns depending on options:
\itemize{
  \item \code{<volume_type>} — Computed volume in m³ (e.g., `V22`, `V22B`, etc.)
  \item \code{Validity_Status} — Indicates if the DHB falls within the validity domain of the equation.
  \item \code{Equation_Used} — Description of the equation applied to each row.
  \item \code{Ecorce_mm} — Estimated bark thickness in millimeters (if `bark = TRUE`).
  \item \code{Biomass_Aboveground}, \code{Biomass_Root}, \code{Biomass_Total} — Biomass components (if `carbon = TRUE`).
  \item \code{Carbon_kg} — Total carbon content in kilograms (if `carbon = TRUE`).
  \item \code{Prediction_Lower}, \code{Prediction_Upper} — Confidence bounds on volume (95% default).
}
}
\description{
This method calculates tree volume, bark thickness, aboveground biomass and associated
carbon stock from individual tree data using species-specific allometric equations.
It includes internal validation and preprocessing steps such as species mapping,
harmonization of diameter/circumference measurements, and height variable consistency.

The function supports several volume types and flexible configurations based on the
source and structure of allometric models stored internally.
}
\examples{
\dontrun{
df <- data.frame(
  Species = "FASY", D130 = 32, C130 = 100,
  HTOT = 25, HDOM = 27
)

result <- carbofor(
  x = df,
  volume_type = "V22",
  carbon = TRUE,
  bark = TRUE,
  specimens = "Species",
  biomass_method = "volume"
)
head(result)
}
}
\seealso{
\code{\link{calculate_volume}}, \code{\link{calculate_biomass}}, \code{\link{calculate_carbon}},
\code{\link{calculate_bark_thickness}}, \code{\link{validate_parameters}}, \code{\link{preprocess_data}}
}
